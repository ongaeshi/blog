---
Title: Siv3DRubyというのを作っている
Date: 2017-05-02T01:14:31+09:00
URL: https://ongaeshi.hatenablog.com/entry/2017/05/02/011431
EditURL: https://blog.hatena.ne.jp/tuto0621/ongaeshi.hatenablog.com/atom/entry/10328749687242165614
---

Windowsでマルチメディアアプリケーションがとても簡単に作れる[http://play-siv3d.hateblo.jp/:title=Siv3D]というライブラリがあるのだが、これにmrubyを組み込んで.exeとRubyスクリプトだけで簡単にマルチメディアアプリが作れるものを考えている。

mrubyはVisualStudioでも簡単にビルドできるようになっているので、作ったlibmruby.libをSiv3Dにリンクして動いたらいいなと思いえいとやってみたが、残念ながら大量のリンクエラー。コンソールアプリやWin32アプリは普通に作れたのでSiv3Dのための特殊なコンパイルオプションが必要なのだろうか。ひとまずおいておく。

作戦2として直接mrubyのソースをSiv3Dのプロジェクトに組み込んで動かしてみる今度は上手くいった！が、Rubyスクリプトが例外を起こしたときにアクセスバイオレーションする。問題その2、ひとまずおいておく。

試しにprintlnとwait_keyを組み込んだらあっさり画面に文字が出た、おおーこれは楽しい。

[f:id:tuto0621:20170502011348j:image]

次はメインループと円を書く関数。Siv3Dはdrawとupdateのように複数のメソッドを要求せずに上から素直に書けるのでRubyと大変相性がよい、、。

[f:id:tuto0621:20170502011358j:image]

ビルドした.exeとmain.rbをまとめて配布すると、なんとメモ帳さえあればVS不要でマルチメディアアプリケーションが作れるようになる。まずはいくつかのサンプルコードがRubyスクリプトで書けるように主要なクラスやメソッドだけを組み込んで評価版Siv3DRubyを作ってみよう。
